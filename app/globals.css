@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* --- TEMA CLARO (Default) --- */
  --bg: #f8fafc;
  --panel: #ffffff;
  --panel-hover: #f1f5f9;
  --border: #e2e8f0;
  --text: #0f172a;
  --text-dim: #64748b;
  --primary: #2563eb;
  --primary-glow: rgba(37, 99, 235, 0.1);
  --success: #10b981; 
  --warning: #f59e0b; 
  --danger: #ef4444;
  --radius: 12px;
  --font: 'Inter', system-ui, sans-serif;
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
}

/* MODO OSCURO */
body.dark {
  --bg: #0f111a; 
  --panel: #161b26; 
  --panel-hover: #1c2333;
  --border: #232d3f;
  --text: #e2e8f0; 
  --text-dim: #94a3b8;
  --primary: #3b82f6;
  --shadow-sm: none;
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.5);
}

/* Reset */
*{ box-sizing:border-box; outline:none; -webkit-tap-highlight-color: transparent; }

body{
  margin:0; font-family: var(--font); color: var(--text); background: var(--bg);
  height: 100vh; display: flex; flex-direction: column; overflow: hidden;
  transition: background 0.3s, color 0.3s;
}

/* Scrollbars finos */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
body.dark ::-webkit-scrollbar-thumb { background: #334155; }

/* HEADER */
header{
  flex: 0 0 auto; background: var(--panel); border-bottom: 1px solid var(--border);
  padding: 10px 20px; z-index: 20; box-shadow: var(--shadow-sm);
}
.top-bar{ display:flex; justify-content:space-between; align-items:center; gap:12px; }
.logo-area{ display:flex; align-items:center; gap:12px; }

/* Nuevo estilo para imagen de logo */
.brand-logo {
  height: 38px;
  width: auto;
  object-fit: contain;
  /* Ajuste para modo oscuro si el logo es oscuro, invertimos ligeramente o mantenemos */
}

.app-title{ font-weight:700; font-size:15px; margin:0; letter-spacing:-0.01em; display:block; }
.app-sub{ font-size:11px; color:var(--text-dim); margin:0; display:block; }

@media (max-width: 600px) {
  .app-sub { display: none; }
  .top-buttons span { display: none; }
  .brand-logo { height: 32px; }
}

/* BUTTONS */
button, input, select, textarea {
  background: var(--panel); border: 1px solid var(--border); color: var(--text);
  padding: 8px 12px; border-radius: 8px; font-family: inherit; font-size: 13px;
  transition: all 0.2s;
}
button{ cursor:pointer; font-weight:600; display:inline-flex; align-items:center; gap:6px; justify-content:center; }
button:hover{ transform:translateY(-1px); border-color:var(--text-dim); }
button:active{ transform:translateY(0); }
.btn-primary{ background: var(--primary); border-color: var(--primary); color: white; }
.btn-primary:hover{ background: #1d4ed8; }
.btn-ghost{ border-color:transparent; background:transparent; color:var(--text-dim); padding: 6px; }
.btn-ghost:hover{ background:var(--panel-hover); color:var(--text); }

/* MAIN LAYOUT */
main{ flex: 1; padding: 16px; overflow: hidden; display: flex; flex-direction: column; width: 100%; position:relative; }

/* CONTROLS BAR */
.controls{ display: flex; gap: 12px; margin-bottom: 12px; align-items: center; justify-content: space-between; flex-wrap: wrap; }
.filters{ display:flex; gap:8px; flex:1; min-width: 200px; overflow-x: auto; padding-bottom: 2px; }

.tabs{ display: flex; background: var(--panel); padding: 3px; border-radius: 8px; border: 1px solid var(--border); }
.tab{
  padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 600; color: var(--text-dim);
  white-space: nowrap; transition: all 0.2s; border: 1px solid transparent;
}
.tab.active{ background: var(--bg); color: var(--primary); border-color: var(--border); box-shadow: var(--shadow-sm); }
body.dark .tab.active { background: #2d3748; color: white; }

/* --- KANBAN --- */
.view-section { display: none; height: 100%; overflow: hidden; animation: fadeIn 0.3s ease; }
.view-section.active { display: block; }
@keyframes fadeIn { from{opacity:0; transform:translateY(5px)} to{opacity:1; transform:translateY(0)} }

.kanban-container{ height: 100%; overflow-x: auto; overflow-y: hidden; padding-bottom: 5px; }
.lanes{ 
  display: flex; gap: 16px; height: 100%; width: max-content; padding-right: 20px;
}

/* COLUMNAS RESPONSIVAS */
.lane{
  width: 300px; /* Ancho base */
  display: flex; flex-direction: column;
  background: #f1f5f9;
  border: 1px solid var(--border); border-radius: var(--radius);
  padding: 10px; height: 100%;
  flex-shrink: 0;
}
body.dark .lane { background: #1a202c; }

/* MÃ“VIL */
@media (max-width: 768px) {
  .kanban-container { scroll-snap-type: x mandatory; padding-right: 16px; }
  .lanes { gap: 12px; padding-right: 16px; }
  .lane { 
    width: 85vw;
    scroll-snap-align: center; 
  }
}

.lane-head{ display:flex; justify-content:space-between; margin-bottom:10px; font-weight:700; font-size:12px; color:var(--text-dim); text-transform:uppercase; letter-spacing:0.05em; align-items: center; }
.counter{ background: rgba(0,0,0,0.06); padding: 2px 8px; border-radius: 10px; font-size:11px; }
body.dark .counter { background: rgba(255,255,255,0.1); }

/* ZONA DE CARDS */
.drop-zone{ 
  flex:1; 
  overflow-y:auto; 
  display:flex; 
  flex-direction:column; 
  gap:10px; 
  padding-bottom:60px;
  min-height: 0; 
}
.drop-zone.drag-over{ background: var(--primary-glow); border: 2px dashed var(--primary); border-radius: 8px; }

/* TARJETAS */
.card{
  background: var(--panel); 
  border: 1px solid var(--border); 
  border-radius: 8px; padding: 12px;
  cursor: grab; position:relative; overflow:hidden;
  box-shadow: var(--shadow-sm);
  flex-shrink: 0;
  min-height: fit-content;
}
.card::before{ content:''; position:absolute; left:0; top:0; bottom:0; width:4px; background:var(--border); }
.card:hover{ transform: translateY(-2px); border-color: var(--primary); box-shadow: var(--shadow-md); z-index:5; }

.card.p-high::before{ background: var(--danger); }
.card.p-med::before{ background: var(--warning); }
.card.p-low::before{ background: var(--success); }

.card-top{ display:flex; justify-content:space-between; margin-bottom:6px; align-items:center; }
.card-title{ font-weight:600; font-size:13px; line-height:1.4; color:var(--text); margin-bottom: 4px; }
.card-desc{ font-size:11px; color:var(--text-dim); margin-bottom:8px; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }

.chips{ display:flex; gap:6px; flex-wrap:wrap; }
.chip{ 
  font-size:10px; padding:2px 6px; border-radius:4px; font-weight: 500;
  background: #f1f5f9; color:var(--text-dim); border:1px solid var(--border); 
}
body.dark .chip { background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); }
.chip.gate{ background: #eff6ff; color: var(--primary); border-color: #dbeafe; font-weight:700; }
body.dark .chip.gate { background: rgba(59,130,246,0.15); color: #93c5fd; border-color: rgba(59,130,246,0.3); }

/* TIMELINE & ANALYTICS */
.timeline-view, .analytics-grid { height: 100%; overflow-y: auto; padding-right: 5px; }
.tl-group{ margin-bottom:20px; }
.tl-header{ position:sticky; top:0; background:var(--bg); padding:8px 0; border-bottom:1px solid var(--border); margin-bottom:10px; z-index:5; font-weight:700; font-size:13px; color:var(--primary); }
.tl-item{ display:flex; gap:10px; background:var(--panel); padding:10px; border-radius:8px; margin-bottom:8px; align-items:center; border:1px solid var(--border); }

.analytics-grid{ 
  display: grid; 
  grid-template-columns: repeat(4, 1fr);
  gap: 20px; 
  grid-auto-rows: min-content; 
}
@media (max-width: 1100px) { .analytics-grid{ grid-template-columns: 1fr 1fr; } }
@media (max-width: 600px) { .analytics-grid{ grid-template-columns: 1fr; } }

.a-card{ background: var(--panel); border: 1px solid var(--border); border-radius: var(--radius); padding: 16px; box-shadow: var(--shadow-sm); display: flex; flex-direction: column; }
.a-card h3{ margin:0 0 12px 0; font-size:14px; font-weight:700; color:var(--text); display:flex; align-items:center; gap:8px; }

.prog-track{ height:6px; background:var(--panel-hover); border:1px solid var(--border); border-radius:3px; overflow:hidden; margin-top:4px; }
.prog-fill{ height:100%; background:var(--primary); width:0%; transition: width 1s ease; border-radius:3px; }
.prog-fill.warn{ background: var(--warning); }

/* MODAL */
.backdrop{ position:fixed; inset:0; background:rgba(0,0,0,0.6); backdrop-filter:blur(2px); z-index:50; display:flex; align-items:center; justify-content:center; padding: 20px; animation: fadeIn 0.1s ease; }
.modal{ background: var(--panel); width:100%; max-width:480px; border-radius:16px; border:1px solid var(--border); overflow:hidden; display:flex; flex-direction:column; max-height:90vh; animation: popIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
@keyframes popIn{ from{transform:scale(0.95)} to{transform:scale(1)} }

.m-head{ padding:12px 16px; border-bottom:1px solid var(--border); display:flex; justify-content:space-between; align-items:center; background:var(--bg); flex-shrink:0; }
.m-body{ padding:16px; overflow-y:auto; flex:1; }
.form-row{ margin-bottom:12px; }
label{ display:block; font-size:10px; text-transform:uppercase; color:var(--text-dim); margin-bottom:4px; font-weight:700; }
.form-grid{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
textarea{ min-height:80px; resize:vertical; width:100%; }
input, select{ width:100%; }
.m-foot{ padding:12px 16px; border-top:1px solid var(--border); display:flex; justify-content:flex-end; gap:10px; background:var(--bg); flex-shrink:0; }

#toast{ position:fixed; bottom:20px; left:50%; transform:translateX(-50%) translateY(100px); background:var(--text); color:var(--bg); padding:10px 20px; border-radius:30px; opacity:0; transition:all 0.3s; z-index:100; font-weight:600; font-size:13px; box-shadow:0 10px 30px rgba(0,0,0,0.3); }
#toast.show{ transform:translateX(-50%) translateY(0); opacity:1; }
